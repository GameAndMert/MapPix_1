(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[895],{7137:function(t,e,n){"use strict";n.d(e,{T:function(){return o},L:function(){return r}});var o="https://api.henrixounez.com/pixworld",r="wss://api.henrixounez.com/pixworld"},5042:function(t,e,n){"use strict";n.d(e,{w:function(){return a},L:function(){return u}});var o,r,a,i=n(6156);!function(t){t[t.UI_BACKGROUND=0]="UI_BACKGROUND",t[t.UI_BACKDROP=1]="UI_BACKDROP",t[t.UI_BORDER=2]="UI_BORDER",t[t.TEXT=3]="TEXT",t[t.LIGHT_TEXT=4]="LIGHT_TEXT",t[t.UNREAD=5]="UNREAD",t[t.LINK=6]="LINK",t[t.HOVERED_LINK=7]="HOVERED_LINK",t[t.ALERT=8]="ALERT"}(a||(a={}));var s=(o={},(0,i.Z)(o,a.UI_BACKGROUND,"#FFFD"),(0,i.Z)(o,a.UI_BACKDROP,"#FFFA"),(0,i.Z)(o,a.UI_BORDER,"#000"),(0,i.Z)(o,a.TEXT,"#000"),(0,i.Z)(o,a.LIGHT_TEXT,"#444"),(0,i.Z)(o,a.UNREAD,"#FF0000"),(0,i.Z)(o,a.LINK,"#428BCA"),(0,i.Z)(o,a.HOVERED_LINK,"#226BAA"),(0,i.Z)(o,a.ALERT,"#FFA9A9cc"),o),c=(r={},(0,i.Z)(r,a.UI_BACKGROUND,"#000D"),(0,i.Z)(r,a.UI_BACKDROP,"#000A"),(0,i.Z)(r,a.UI_BORDER,"#FFF"),(0,i.Z)(r,a.TEXT,"#FFF"),(0,i.Z)(r,a.LIGHT_TEXT,"#AAA"),(0,i.Z)(r,a.UNREAD,"#FF0000"),(0,i.Z)(r,a.LINK,"#428BCA"),(0,i.Z)(r,a.HOVERED_LINK,"#226BAA"),(0,i.Z)(r,a.ALERT,"#FFA9A9cc"),r);function u(t,e){return e?c[t]:s[t]}},3848:function(t,e){"use strict";var n;!function(t){t[t.NONE=0]="NONE",t[t.INFOS=1]="INFOS",t[t.PROBLEM=2]="PROBLEM",t[t.CONVERTER=3]="CONVERTER",t[t.PARAMETERS=4]="PARAMETERS",t[t.CAPTCHA=5]="CAPTCHA",t[t.OVERLAY=6]="OVERLAY",t[t.BOOKMARKS=7]="BOOKMARKS",t[t.CANVASES=8]="CANVASES",t[t.MODERATION=9]="MODERATION"}(n||(n={})),e.Z=n},8200:function(t,e,n){"use strict";n.d(e,{k:function(){return o},Z:function(){return r}});var o=256,r=50},4152:function(t,e,n){"use strict";n.d(e,{rX:function(){return L},sZ:function(){return _},Hm:function(){return N},Y9:function(){return B},mh:function(){return U},IN:function(){return X}});var o=n(7329),r=n(7757),a=n.n(r),i=n(2137),s=n(6610),c=n(5991),u=n(6156),l=n(7137),h=n(8200),d=function(){function t(e,n){(0,s.Z)(this,t),(0,u.Z)(this,"canvas",void 0),(0,u.Z)(this,"position",{x:0,y:0}),(0,u.Z)(this,"chunkSize",void 0),this.canvas=document.createElement("canvas"),this.canvas.width=h.k,this.canvas.height=h.k,this.position=e,this.chunkSize=n}return(0,c.Z)(t,[{key:"displayImg",value:function(t){var e=this.canvas.getContext("2d");e&&(e.imageSmoothingEnabled=!1,e.drawImage(t,0,0))}},{key:"fetchImage",value:function(t){var e=this;return new Promise((function(n){var o=new Image;o.setAttribute("crossOrigin",""),o.onload=function(){return o.onload=null,e.displayImg(o),n(o)},o.src=t}))}},{key:"loadImage",value:function(t){var e=this.canvas.getContext("2d");e&&(e.imageSmoothingEnabled=!1,e.drawImage(t,0,0))}},{key:"toHex",value:function(t){var e=t.toString(16);return 1===e.length?"0"+e:e}},{key:"getColorAt",value:function(t,e){var n=this.canvas.getContext("2d");if(!n)return"#000000";var o=n.getImageData(t,e,1,1).data;return 0===o[3]?"#0000":("#"+this.toHex(o[0])+this.toHex(o[1])+this.toHex(o[2])).toUpperCase()}},{key:"placePixel",value:function(t,e,n){var o=this.canvas.getContext("2d");o&&("#0000"!==n?(o.fillStyle=n,o.fillRect(t,e,1,1)):o.clearRect(t,e,1,1))}}]),t}(),v=n(6486),p=n(3596),f=n(7438),y=n(9968),g=n(8296),m=n(3555),C=n(2929),O=n(1551),S=n(3848),w=n(5042);function b(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function k(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?b(Object(n),!0).forEach((function(e){(0,u.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var x=function(){function t(e){var n=this;(0,s.Z)(this,t),(0,u.Z)(this,"canvasController",void 0),(0,u.Z)(this,"shiftPressed",!1),(0,u.Z)(this,"rightShiftPressed",!1),(0,u.Z)(this,"isMouseDown",!1),(0,u.Z)(this,"isZooming",!1),(0,u.Z)(this,"isMoving",!1),(0,u.Z)(this,"isAutoBrushing",!1),(0,u.Z)(this,"startMove",{x:0,y:0}),(0,u.Z)(this,"pinchDistance",0),(0,u.Z)(this,"longTouchTimeout",null),(0,u.Z)(this,"haveMouseOver",!0),(0,u.Z)(this,"cursorPosition",{x:0,y:0}),(0,u.Z)(this,"setSelectedColor",(function(t){null===p.h||void 0===p.h||p.h.dispatch({type:g.Du,payload:t})})),(0,u.Z)(this,"resize",(function(t){var e=t.target;n.canvasController.size={width:e.innerWidth,height:e.innerHeight},n.canvas.width=n.canvasController.size.width,n.canvas.height=n.canvasController.size.height,null===p.h||void 0===p.h||p.h.dispatch({type:g.r2,payload:!0})})),(0,u.Z)(this,"mouseDown",(function(t){if(n.isMouseDown=!0,n.autoBrush){n.isAutoBrushing=!0;var e=n.canvasController.canvasToCoordinates(t.clientX,t.clientY),o=e.coordX,r=e.coordY;n.canvasController.placeUserPixel(o,r,n.currentColor)}})),(0,u.Z)(this,"mouseMove",(function(t){if(!0!==n.isMouseDown||n.autoBrush){n.cursorPosition={x:t.clientX,y:t.clientY};var e=n.canvasController.canvasToCoordinates(n.cursorPosition.x,n.cursorPosition.y),o=e.coordX,r=e.coordY;null===p.h||void 0===p.h||p.h.dispatch({type:f.G8,payload:{x:o,y:r}}),!0===n.shiftPressed||n.isMouseDown&&n.isAutoBrushing&&n.autoBrush?n.canvasController.placeUserPixel(o,r,n.currentColor):1==n.rightShiftPressed&&n.canvasController.placeUserPixel(o,r,n.canvasController.getColorOnCoordinates(o,r,!0))}else{n.isMoving||(n.startMove={x:t.clientX,y:t.clientY},n.isMoving=!0);var a=h.Z/n.position.zoom;n.canvasController.changePosition((n.startMove.x-t.clientX)/a,(n.startMove.y-t.clientY)/a),n.startMove={x:t.clientX,y:t.clientY}}})),(0,u.Z)(this,"throttledMouseMove",(0,v.throttle)(this.mouseMove,N)),(0,u.Z)(this,"mouseUp",(function(t){if(!0===n.isMoving)n.startMove={x:0,y:0},n.isMoving=!1;else if(0===t.button)if(null!==p.h&&void 0!==p.h&&p.h.getState().overlay.positionMouse)p.h.dispatch({type:y.tt,payload:!1});else if(n.isMouseDown){var e=n.canvasController.canvasToCoordinates(t.clientX,t.clientY),o=e.coordX,r=e.coordY;n.canvasController.placeUserPixel(o,r,n.currentColor)}n.isMouseDown=!1})),(0,u.Z)(this,"mouseEnter",(function(){n.haveMouseOver=!0})),(0,u.Z)(this,"mouseLeave",(function(){n.haveMouseOver=!1,n.shiftPressed=!1,n.rightShiftPressed=!1,n.startMove={x:0,y:0},n.isMoving=!1,n.isMouseDown=!1})),(0,u.Z)(this,"auxclick",(function(t){if(1===t.button){var e=n.canvasController.canvasToCoordinates(t.clientX,t.clientY),o=e.coordX,r=e.coordY,a=n.canvasController.getColorOnCoordinates(o,r);a&&n.setSelectedColor(a),t.stopPropagation()}})),(0,u.Z)(this,"zoom",(function(t){null!==p.h&&void 0!==p.h&&p.h.getState().zoomTowardCursor?n.canvasController.changeZoom(t.deltaY<0?.9:1.1,t.clientX,t.clientY):n.canvasController.changeZoom(t.deltaY<0?.9:1.1,n.canvasController.size.width/2,n.canvasController.size.height/2)})),(0,u.Z)(this,"throttledZoom",(0,v.throttle)(this.zoom,N)),(0,u.Z)(this,"keydown",(function(t){switch(t.code){case"ArrowUp":n.canvasController.changePosition(0,-4*n.position.zoom);break;case"ArrowDown":n.canvasController.changePosition(0,4*n.position.zoom);break;case"ArrowLeft":n.canvasController.changePosition(-4*n.position.zoom,0);break;case"ArrowRight":n.canvasController.changePosition(4*n.position.zoom,0);break;case"ShiftLeft":if(n.haveMouseOver){n.shiftPressed=!0;var e=n.canvasController.canvasToCoordinates(n.cursorPosition.x,n.cursorPosition.y),o=e.coordX,r=e.coordY;n.canvasController.placeUserPixel(o,r,n.currentColor)}break;case"ShiftRight":if(n.haveMouseOver){n.rightShiftPressed=!0;var a=n.canvasController.canvasToCoordinates(n.cursorPosition.x,n.cursorPosition.y),i=a.coordX,s=a.coordY;n.canvasController.placeUserPixel(i,s,n.canvasController.getColorOnCoordinates(i,s,!0))}break;case"KeyH":null===p.h||void 0===p.h||p.h.dispatch({type:C.US,payload:!(null!==p.h&&void 0!==p.h&&p.h.getState().history.activate)}),null===p.h||void 0===p.h||p.h.dispatch({type:g.r2,payload:!0}),null!==p.h&&void 0!==p.h&&p.h.getState().history.activate&&(null===p.h||void 0===p.h?void 0:p.h.getState().position.zoom)>25&&(null===p.h||void 0===p.h||p.h.dispatch({type:g.V1,payload:k(k({},n.position),{},{zoom:25})}));break;case"ControlLeft":var c=n.canvasController.canvasToCoordinates(n.cursorPosition.x,n.cursorPosition.y),u=c.coordX,l=c.coordY,h=n.canvasController.getColorOnCoordinates(u,l);h&&h!==(null===p.h||void 0===p.h?void 0:p.h.getState().selectedColor)&&(n.canvasController.soundController.playSound(O.w.OPTIONS),n.setSelectedColor(h));break;case"KeyF":null===p.h||void 0===p.h||p.h.dispatch({type:f.ZS,payload:!p.h.getState().searchActive}),t.stopPropagation(),t.preventDefault()}})),(0,u.Z)(this,"keypress",(function(t){switch(t.code){case"KeyE":n.canvasController.changeZoom(.9,n.canvasController.size.width/2,n.canvasController.size.height/2);break;case"KeyQ":n.canvasController.changeZoom(1.1,n.canvasController.size.width/2,n.canvasController.size.height/2);break;case"KeyW":n.canvasController.changePosition(0,-4*n.position.zoom);break;case"KeyS":n.canvasController.changePosition(0,4*n.position.zoom);break;case"KeyA":n.canvasController.changePosition(-4*n.position.zoom,0);break;case"KeyD":n.canvasController.changePosition(4*n.position.zoom,0);break;case"KeyO":null===p.h||void 0===p.h||p.h.dispatch({type:y.QF,payload:!p.h.getState().overlay.activate});break;case"KeyG":null===p.h||void 0===p.h||p.h.dispatch({type:f.kA,payload:{show:!0,text:p.h.getState().gridActive?"hideGrid":"showGrid",color:w.w.UI_BACKGROUND}}),null===p.h||void 0===p.h||p.h.dispatch({type:m.EA,payload:!p.h.getState().gridActive});break;case"KeyX":null===p.h||void 0===p.h||p.h.dispatch({type:f.kA,payload:{show:!0,text:p.h.getState().activity?"hideActivity":"showActivity",color:w.w.UI_BACKGROUND}}),null===p.h||void 0===p.h||p.h.dispatch({type:m.jt,payload:!p.h.getState().activity});break;case"KeyB":null===p.h||void 0===p.h||p.h.dispatch({type:f.i0,payload:S.Z.BOOKMARKS});break;case"KeyU":null===p.h||void 0===p.h||p.h.dispatch({type:m.pq,payload:!p.h.getState().autoBrush});break;case"KeyL":n.canvasController.setZoom(h.Z);break;default:switch(t.key){case"m":null===p.h||void 0===p.h||p.h.dispatch({type:f.kA,payload:{show:!0,text:p.h.getState().sounds?"muted":"unmuted",color:w.w.UI_BACKGROUND}}),null===p.h||void 0===p.h||p.h.dispatch({type:m.iz,payload:!p.h.getState().sounds});break;case"C":if(navigator.clipboard){var e,o=p.h.getState().position,r=window.location.origin+'?pos="'.concat(null===p.h||void 0===p.h||null===(e=p.h.getState().canvases.find((function(t){return t.id===(null===p.h||void 0===p.h?void 0:p.h.getState().currentCanvas)})))||void 0===e?void 0:e.letter,"(").concat(Math.round(o.x),",").concat(Math.round(o.y),",").concat(Math.round(o.zoom),')"');navigator.clipboard.writeText(r),null===p.h||void 0===p.h||p.h.dispatch({type:f.kA,payload:{show:!0,text:"clipboard",color:w.w.UI_BACKGROUND}})}break;case"c":if(navigator.clipboard){var a,i=p.h.getState().cursorPos,s=p.h.getState().position,c="#".concat(null===p.h||void 0===p.h||null===(a=p.h.getState().canvases.find((function(t){return t.id===(null===p.h||void 0===p.h?void 0:p.h.getState().currentCanvas)})))||void 0===a?void 0:a.letter,"(").concat(Math.round(i.x),",").concat(Math.round(i.y),",").concat(Math.round(s.zoom),")");navigator.clipboard.writeText(c),null===p.h||void 0===p.h||p.h.dispatch({type:f.kA,payload:{show:!0,text:"clipboard",color:w.w.UI_BACKGROUND}})}}}})),(0,u.Z)(this,"keyup",(function(t){switch(t.code){case"ShiftLeft":n.shiftPressed=!1;break;case"ShiftRight":n.rightShiftPressed=!1}})),(0,u.Z)(this,"onLongTouch",(function(t){if(null!==n.longTouchTimeout&&!n.autoBrush){var e=n.canvasController.canvasToCoordinates(t.touches[0].clientX,t.touches[0].clientY),o=e.coordX,r=e.coordY,a=n.canvasController.getColorOnCoordinates(o,r);a&&n.setSelectedColor(a)}})),(0,u.Z)(this,"touchStart",(function(t){n.longTouchTimeout=setTimeout((function(){return n.onLongTouch(t)}),500),1===t.touches.length?n.isAutoBrushing=!0:n.isAutoBrushing=!1,t.stopPropagation(),t.preventDefault()})),(0,u.Z)(this,"touchEnd",(function(t){if(0===t.touches.length){if(!n.isMoving&&0===n.pinchDistance){var e=n.canvasController.canvasToCoordinates(t.changedTouches[0].clientX,t.changedTouches[0].clientY),o=e.coordX,r=e.coordY;n.canvasController.placeUserPixel(o,r,n.currentColor)}n.pinchDistance=0,n.longTouchTimeout&&clearTimeout(n.longTouchTimeout),n.longTouchTimeout=null,n.pinchDistance=0,n.startMove={x:0,y:0},n.isMoving=!1,n.isMouseDown=!1,n.isZooming=!1,n.isAutoBrushing=!1}})),(0,u.Z)(this,"touchCancel",(function(t){n.touchEnd(t)})),(0,u.Z)(this,"touchLeave",(function(t){n.touchEnd(t)})),(0,u.Z)(this,"touchMove",(function(t){var e=t.touches;t.preventDefault();var o=e[0];if(1===e.length&&n.autoBrush){if(n.isAutoBrushing){var r=n.canvasController.canvasToCoordinates(o.clientX,o.clientY),a=r.coordX,i=r.coordY;n.canvasController.placeUserPixel(a,i,n.currentColor)}}else{(!n.isMouseDown||n.isZooming&&1===e.length)&&(n.startMove={x:o.clientX,y:o.clientY},n.isMouseDown=!0,1===e.length&&(n.isZooming=!1));var s=h.Z/n.position.zoom;if(Math.hypot(n.startMove.x-o.clientX,n.startMove.y-o.clientY)>0&&(n.isMoving=!0,n.longTouchTimeout&&clearTimeout(n.longTouchTimeout),n.longTouchTimeout=null,n.canvasController.changePosition((n.startMove.x-o.clientX)/s,(n.startMove.y-o.clientY)/s),n.startMove={x:o.clientX,y:o.clientY},2===e.length)){n.isZooming=!0;var c=e[0].clientX-e[1].clientX,u=e[0].clientY-e[1].clientY,l=Math.hypot(c,u);if(0!==n.pinchDistance){var d=(n.pinchDistance-l)/10;null!==p.h&&void 0!==p.h&&p.h.getState().zoomTowardCursor?n.canvasController.changeZoom(d<0?.95:1.05,e[1].clientX+c/2,e[1].clientY+u/2):n.canvasController.changeZoom(d<0?.95:1.05,n.canvasController.size.width/2,n.canvasController.size.height/2)}n.pinchDistance=l}}})),this.canvasController=e,this.canvas.addEventListener("mousedown",this.mouseDown),this.canvas.addEventListener("mousemove",this.throttledMouseMove),this.canvas.addEventListener("mouseup",this.mouseUp),this.canvas.addEventListener("mouseenter",this.mouseEnter),this.canvas.addEventListener("mouseleave",this.mouseLeave),this.canvas.addEventListener("auxclick",this.auxclick),this.canvas.addEventListener("wheel",this.throttledZoom),this.canvas.addEventListener("touchstart",this.touchStart),this.canvas.addEventListener("touchend",this.touchEnd),this.canvas.addEventListener("touchcancel",this.touchCancel),this.canvas.addEventListener("touchleave",this.touchLeave),this.canvas.addEventListener("touchmove",this.touchMove),this.canvas.addEventListener("keypress",this.keypress),this.canvas.addEventListener("keydown",this.keydown),this.canvas.addEventListener("keyup",this.keyup),window.addEventListener("resize",this.resize)}return(0,c.Z)(t,[{key:"destructor",value:function(){this.canvas.removeEventListener("mousedown",this.mouseDown),this.canvas.removeEventListener("mousemove",this.throttledMouseMove),this.canvas.removeEventListener("mouseup",this.mouseUp),this.canvas.removeEventListener("mouseenter",this.mouseEnter),this.canvas.removeEventListener("mouseleave",this.mouseLeave),this.canvas.removeEventListener("auxclick",this.auxclick),this.canvas.removeEventListener("wheel",this.throttledZoom),this.canvas.removeEventListener("touchstart",this.touchStart),this.canvas.removeEventListener("touchend",this.touchEnd),this.canvas.removeEventListener("touchcancel",this.touchCancel),this.canvas.removeEventListener("touchleave",this.touchLeave),this.canvas.removeEventListener("touchmove",this.touchMove),this.canvas.removeEventListener("keypress",this.keypress),this.canvas.removeEventListener("keydown",this.keydown),this.canvas.removeEventListener("keyup",this.keyup),window.removeEventListener("resize",this.resize)}},{key:"position",get:function(){return this.canvasController.position}},{key:"currentColor",get:function(){var t;return(null===p.h||void 0===p.h?void 0:p.h.getState().selectedColor)||(null===p.h||void 0===p.h||null===(t=p.h.getState().canvases.find((function(t){return t.id===(null===p.h||void 0===p.h?void 0:p.h.getState().currentCanvas)})))||void 0===t?void 0:t.palette[0])||"#FFFFFF"}},{key:"canvas",get:function(){return this.canvasController.canvas}},{key:"autoBrush",get:function(){return null===p.h||void 0===p.h?void 0:p.h.getState().autoBrush}}]),t}(),E=n(9669),T=n.n(E),P=n(1053),I=n(3791),Z=function(){function t(e,n){var o=this;(0,s.Z)(this,t),(0,u.Z)(this,"canvasController",void 0),(0,u.Z)(this,"ws",void 0),(0,u.Z)(this,"isInit",!1),(0,u.Z)(this,"getMe",(0,i.Z)(a().mark((function t(){var e,n,r;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=localStorage.getItem("token"),o.isInit&&e&&(null===p.h||void 0===p.h||!p.h.getState().user)){t.next=3;break}return t.abrupt("return");case 3:return t.prev=3,t.next=6,T().get("".concat(l.T,"/user/me"),{headers:{Authorization:e}});case 6:n=t.sent,localStorage.setItem("token",n.headers.authorization),null===p.h||void 0===p.h||p.h.dispatch({type:I.QE,payload:n.data}),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(3),401===(null===(r=t.t0.response)||void 0===r?void 0:r.status)&&localStorage.removeItem("token");case 14:case"end":return t.stop()}}),t,null,[[3,11]])})))),(0,u.Z)(this,"sendToWs",(function(t,e){o.ws.readyState!==WebSocket.CLOSING&&o.ws.readyState!==WebSocket.CLOSED?o.ws.readyState!==WebSocket.CONNECTING&&o.ws.send(JSON.stringify({type:t,data:e})):window.location.reload()})),this.canvasController=e,this.ws=new WebSocket("".concat(l.L,"/pix/connect?hash=").concat(n)),this.ws.onopen=function(){o.getMe()},this.ws.onclose=function(t){o.isInit=!1,t.wasClean&&1013!==t.code||setTimeout((function(){return null===p.h||void 0===p.h?void 0:p.h.dispatch({type:f.i0,payload:S.Z.PROBLEM})}),2e3)},this.ws.onerror=function(){o.isInit=!1,setTimeout((function(){return null===p.h||void 0===p.h?void 0:p.h.dispatch({type:f.i0,payload:S.Z.PROBLEM})}),2e3)},this.ws.onmessage=function(t){var e=JSON.parse(t.data),n=e.type,r=e.data;switch(n){case"init":o.isInit=!0,null===p.h||void 0===p.h||p.h.dispatch({type:g.sW,payload:!0}),null===p.h||void 0===p.h||p.h.dispatch({type:f.jz,payload:r.playerNb}),null===p.h||void 0===p.h||p.h.dispatch({type:f.lk,payload:r.cooldown}),null===p.h||void 0===p.h||p.h.dispatch({type:P.P9,payload:r.chatMessages}),null===p.h||void 0===p.h||p.h.dispatch({type:f.Kv,payload:r.lastNotification}),null!==p.h&&void 0!==p.h&&p.h.getState().currentCanvas||(null===p.h||void 0===p.h||p.h.dispatch({type:m.bz,payload:o.canvasController.canvases[0].id}),null===p.h||void 0===p.h||p.h.dispatch({type:g.Du,payload:o.canvasController.canvases[0].palette[0]})),o.getMe(),localStorage.removeItem("badConnection");break;case"placePixel":r.canvas===(null===p.h||void 0===p.h?void 0:p.h.getState().currentCanvas)&&(o.canvasController.placePixel(r.x,r.y,r.color),o.canvasController.pixelActivity.push({x:r.x,y:r.y,frame:0}));break;case"playerNb":null===p.h||void 0===p.h||p.h.dispatch({type:f.jz,payload:r});break;case"confirmPixel":null===p.h||void 0===p.h||p.h.dispatch({type:f.lk,payload:r.cd}),null===p.h||void 0===p.h||p.h.dispatch({type:I.Cc,payload:{totalPixels:r.totalPixels,dailyPixels:r.dailyPixels}}),o.canvasController.confirmPixel(r.pos.x,r.pos.y);break;case"refusePixel":null===p.h||void 0===p.h||p.h.dispatch({type:f.lk,payload:r.cd}),null===p.h||void 0===p.h||p.h.dispatch({type:f.kA,payload:{show:!0,text:r.reason,color:w.w.ALERT}}),o.canvasController.restorePixel(r.pos.x,r.pos.y);break;case"chatMessage":null===p.h||void 0===p.h||p.h.dispatch({type:P.Qn,payload:r});break;case"clearChatMessages":null===p.h||void 0===p.h||p.h.dispatch({type:P.BZ,payload:r});break;case"captchaNeeded":null===p.h||void 0===p.h||p.h.dispatch({type:f.i0,payload:S.Z.CAPTCHA}),o.canvasController.restorePixel(r.pos.x,r.pos.y);break;case"refreshChunks":null===p.h||void 0===p.h||p.h.dispatch({type:g.c5,payload:{refresh:!0,chunks:r.chunks}}),null===p.h||void 0===p.h||p.h.dispatch({type:g.r2,payload:!0});break;case"disconnect":if(o.isInit=!1,null===p.h||void 0===p.h||p.h.dispatch({type:f.dd,payload:r}),null===p.h||void 0===p.h||p.h.dispatch({type:f.i0,payload:S.Z.PROBLEM}),"Bad connection request."===r)"true"===localStorage.getItem("badConnection")?(localStorage.removeItem("token"),localStorage.removeItem("badConnection")):(localStorage.setItem("badConnection","true"),location.reload());break;case"newNotification":null===p.h||void 0===p.h||p.h.dispatch({type:f.Kv,payload:r})}}}return(0,c.Z)(t,[{key:"destructor",value:function(){this.ws.close()}}]),t}(),A=n(4684),D=function(){function t(e){var n=this;(0,s.Z)(this,t),(0,u.Z)(this,"canvasController",void 0),(0,u.Z)(this,"imgUrl",void 0),(0,u.Z)(this,"unsubscribe",void 0),(0,u.Z)(this,"canvas",void 0),this.canvasController=e,this.canvas=document.createElement("canvas"),this.canvas.width=0,this.canvas.height=0,this.imgUrl=(null===p.h||void 0===p.h?void 0:p.h.getState().overlay.image)||"",this.imgUrl&&this.setImage(this.imgUrl),this.unsubscribe=p.h.subscribe((function(){if(p.h){var t,e,o=p.h.getState(),r=o.overlay.image;r!==n.imgUrl&&r&&n.setImage(r),!o.overlay.positionMouse||(null!==(t=o.overlay.position.x)&&void 0!==t?t:0)===o.cursorPos.x&&(null!==(e=o.overlay.position.y)&&void 0!==e?e:0)===o.cursorPos.y||p.h.dispatch({type:y.fA,payload:o.cursorPos})}}))}return(0,c.Z)(t,[{key:"destructor",value:function(){this.unsubscribe()}},{key:"render",value:function(t){if(this.imgUrl&&this.activate&&this.canvas.height>0){var e,n;t.imageSmoothingEnabled=!1,t.globalAlpha=this.transparency;var o=h.Z/this.canvasController.position.zoom,r=this.canvasController.coordinatesOnCanvas(null!==(e=this.position.x)&&void 0!==e?e:0,null!==(n=this.position.y)&&void 0!==n?n:0),a=r.posX,i=r.posY;t.drawImage(this.canvas,a,i,this.canvas.width*o,this.canvas.height*o),t.globalAlpha=1}}},{key:"setImage",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.imgUrl=t;var o=new Image;n||(o.crossOrigin="anonymous"),o.src=t,o.onload=function(){var t=e.canvas.getContext("2d");e.canvas.width=o.width,e.canvas.height=o.height,t&&(t.imageSmoothingEnabled=!1,t.drawImage(o,0,0),null===p.h||void 0===p.h||p.h.dispatch({type:g.r2,payload:!0}));try{null===t||void 0===t||t.getImageData(0,0,1,1),null===p.h||void 0===p.h||p.h.dispatch({type:y.UU,payload:!1})}catch(n){null===p.h||void 0===p.h||p.h.dispatch({type:y.El,payload:!1}),null===p.h||void 0===p.h||p.h.dispatch({type:y.UU,payload:!0})}},o.onerror=function(){n||e.setImage(t,!0)}}},{key:"toHex",value:function(t){var e=t.toString(16);return 1===e.length?"0"+e:e}},{key:"getColorAt",value:function(t,e){var n,o,r=this.canvas.getContext("2d");if(!r)return null;var a=r.getImageData(t,e,1,1).data,i=(0,A.dd)(null!==(n=null===p.h||void 0===p.h||null===(o=p.h.getState().canvases.find((function(t){return t.id===(null===p.h||void 0===p.h?void 0:p.h.getState().currentCanvas)})))||void 0===o?void 0:o.palette)&&void 0!==n?n:[]);i.push([0,0,0,0]);var s=(0,A.h5)([a[0],a[1],a[2],a[3]],i);return 0===s[0]&&0===s[1]&&0===s[2]&&0===s[3]?null:("#"+this.toHex(s[0])+this.toHex(s[1])+this.toHex(s[2])).toUpperCase()}},{key:"activate",get:function(){return p.h.getState().overlay.activate}},{key:"position",get:function(){return p.h.getState().overlay.position}},{key:"transparency",get:function(){return p.h.getState().overlay.transparency}}]),t}();function R(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function M(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?R(Object(n),!0).forEach((function(e){(0,u.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):R(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var N=25,_=3e3,L=6,j=function(){function t(e,n){var r=this;(0,s.Z)(this,t),(0,u.Z)(this,"canvas",void 0),(0,u.Z)(this,"size",{width:0,height:0}),(0,u.Z)(this,"chunks",{}),(0,u.Z)(this,"historyChunks",{}),(0,u.Z)(this,"superChunks",[]),(0,u.Z)(this,"waitingPixels",{}),(0,u.Z)(this,"pixelActivity",[]),(0,u.Z)(this,"activityTimeout",null),(0,u.Z)(this,"interactionController",void 0),(0,u.Z)(this,"connectionController",void 0),(0,u.Z)(this,"overlayController",void 0),(0,u.Z)(this,"soundController",void 0),(0,u.Z)(this,"coordinatesOnCanvas",(function(t,e,n){var o=r.position,a=o.x,i=o.y,s=n||r.position.zoom,c=r.size.width,u=r.size.height,l=h.Z/s;return{posX:c/2+(-a+t)*l,posY:u/2+(-i+e)*l}})),(0,u.Z)(this,"canvasToCoordinates",(function(t,e){var n=r.position,o=n.zoom,a=n.x,i=n.y,s=r.size.width,c=r.size.height,u=h.Z/o,l=s/2,d=c/2;return{coordX:Math.floor((t-l+a*u)/u),coordY:Math.floor((e-d+i*u)/u)}})),(0,u.Z)(this,"canSuperchunkLoadOrDisplay",(function(t,e){var n,o=h.Z/r.position.zoom;return t===(null===e||void 0===e||null===(n=e.superchunkLevels)||void 0===n?void 0:n.length)-1||o>Math.pow(.25,t+2)})),(0,u.Z)(this,"loadSuperchunks",(0,i.Z)(a().mark((function t(){var e,n,o;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=r.currentCanvas,n=r.size.width,o=r.size.height,e){t.next=5;break}return t.abrupt("return");case 5:0===r.superChunks.length&&(r.superChunks=e.superchunkLevels.map((function(){return{}}))),e.superchunkLevels.forEach(function(){var t=(0,i.Z)(a().mark((function t(i,s){var c,u,v,f,y,m,C,O,S,w,b,k;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r.canSuperchunkLoadOrDisplay(s,e)){t.next=2;break}return t.abrupt("return");case 2:c=e.size*h.k/i,u=r.canvasToCoordinates(0,0),v=r.canvasToCoordinates(n,o),f=e.size*h.k/2,y=u.coordX+f-c/2;case 7:if(!(y<v.coordX+f+c/2)){t.next=32;break}m=u.coordY+f-c/2;case 9:if(!(m<v.coordY+f+c/2)){t.next=29;break}if(C=Math.floor(y/c),O=Math.floor(m/c),S=C-i/2,w=O-i/2,!(C>=i||O>=i||C<0||O<0)){t.next=16;break}return t.abrupt("continue",26);case 16:if(!r.superChunks[s]["".concat(C,";").concat(O)]){t.next=18;break}return t.abrupt("continue",26);case 18:return b=new d({x:S,y:w},e.size*h.k/i),k=b.fetchImage("".concat(l.T,"/superchunk/").concat(r.currentCanvasId,"/").concat(s,"/").concat(C,"/").concat(O)),r.superChunks[s]["".concat(C,";").concat(O)]=b,t.t0=b,t.next=24,k;case 24:t.t1=t.sent,t.t0.loadImage.call(t.t0,t.t1);case 26:m+=c,t.next=9;break;case 29:y+=c,t.next=7;break;case 32:null===p.h||void 0===p.h||p.h.dispatch({type:g.r2,payload:!0});case 33:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}());case 7:case"end":return t.stop()}}),t)})))),(0,u.Z)(this,"getChunkUrl",(function(t,e,n){var o=p.h.getState().history,a=o.date,i=o.hour;return n?"".concat(l.T,"/history/chunk/").concat(a,"/").concat(i,"/").concat(r.currentCanvasId,"/").concat(t,"/").concat(e):"".concat(l.T,"/chunk/").concat(r.currentCanvasId,"/").concat(t,"/").concat(e).concat(null!==p.h&&void 0!==p.h&&p.h.getState().eraserMode?"?noBg":"")})),(0,u.Z)(this,"loadChunk",function(){var t=(0,i.Z)(a().mark((function t(e,n){var o,i,s,c,u,l,v,f,y,m,C,O=arguments;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=O.length>2&&void 0!==O[2]&&O[2],-1!==r.currentCanvasIndex){t.next=3;break}return t.abrupt("return");case 3:if(i=r.currentCanvas.boundingChunks[0],s=r.currentCanvas.boundingChunks[1],!(e<i[0]||n<i[1]||e>s[0]||n>s[1])){t.next=7;break}return t.abrupt("return");case 7:if(c=p.h.getState().history,u=c.activate,l=c.date,v=c.hour,!u||""!==l&&""!==v){t.next=10;break}return t.abrupt("return");case 10:if(f=u,y=r.getChunkUrl(e,n,f),o||!r.currentChunks["".concat(e,";").concat(n)]){t.next=14;break}return t.abrupt("return");case 14:return t.prev=14,m=new d({x:e,y:n},h.k),C=m.fetchImage(y),r.currentChunks["".concat(e,";").concat(n)]=m,t.t0=m,t.next=21,C;case 21:t.t1=t.sent,t.t0.loadImage.call(t.t0,t.t1),null===p.h||void 0===p.h||p.h.dispatch({type:g.r2,payload:!0}),t.next=29;break;case 26:t.prev=26,t.t2=t.catch(14),console.error(t.t2);case 29:case"end":return t.stop()}}),t,null,[[14,26]])})));return function(e,n){return t.apply(this,arguments)}}()),(0,u.Z)(this,"loadNeighboringChunks",(0,i.Z)(a().mark((function t(){var e,n,o,i,s,c,u;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null===p.h||void 0===p.h||p.h.dispatch({type:g.sW,payload:!1}),r.canvases.length&&r.loadSuperchunks(),!(h.Z/r.position.zoom<.5)){t.next=5;break}return t.abrupt("return");case 5:for(e=r.size.width,n=r.size.height,o=Math.ceil(e/h.k)+2,i=Math.ceil(n/h.k)+2,s=[],c=r.position.x-h.k*(o/2);c<r.position.x+h.k*(o/2);c+=h.k)for(u=r.position.y-h.k*(i/2);u<r.position.y+h.k*(i/2);u+=h.k)s.push(r.loadChunk(Math.floor(c/h.k),Math.floor(u/h.k)));return t.next=13,Promise.all(s);case 13:case"end":return t.stop()}}),t)})))),(0,u.Z)(this,"refreshChunks",function(){var t=(0,i.Z)(a().mark((function t(e){var n,i,s;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=(0,o.Z)(e),null===p.h||void 0===p.h||p.h.dispatch({type:g.c5,payload:{refresh:!1,chunks:[]}}),!(h.Z/r.position.zoom<.5)){t.next=5;break}return t.abrupt("return");case 5:i=[],s=0;case 7:if(!(s<n.length)){t.next=15;break}if(n[s].canvas===r.currentCanvasId){t.next=10;break}return t.abrupt("continue",12);case 10:delete r.chunks["".concat(n[s].x,";").concat(n[s].y)],i.push(r.loadChunk(n[s].x,n[s].y));case 12:s++,t.next=7;break;case 15:return t.next=17,Promise.all(i);case 17:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),(0,u.Z)(this,"placePixel",(function(t,e,n){var o=Math.floor(t/h.k),a=Math.floor(e/h.k);if(r.chunks["".concat(o,";").concat(a)]){var i=t%h.k,s=e%h.k;i=i>=0?i:h.k+i,s=s>=0?s:h.k+s;var c=r.chunks["".concat(o,";").concat(a)].getColorAt(i,s);if(c!==n)return r.chunks["".concat(o,";").concat(a)].placePixel(i,s,n),null===p.h||void 0===p.h||p.h.dispatch({type:g.r2,payload:!0}),c}return null})),(0,u.Z)(this,"placeUserPixel",(function(t,e,n){if(!(r.position.zoom>10||null!==p.h&&void 0!==p.h&&p.h.getState().history.activate)){var o=n;if(null!==p.h&&void 0!==p.h&&p.h.getState().overlay.activate&&null!==p.h&&void 0!==p.h&&p.h.getState().overlay.autoColor){var a,i,s=p.h.getState().overlay.position,c=r.overlayController.getColorAt(t-(null!==(a=s.x)&&void 0!==a?a:0),e-(null!==(i=s.y)&&void 0!==i?i:0));if(!c)return;o=c}null!==p.h&&void 0!==p.h&&p.h.getState().eraserMode&&(o="#0000");var u=r.placePixel(t,e,o);u&&(r.waitingPixels["".concat(t,";").concat(e)]=u,r.connectionController.sendToWs("placePixel",{x:t,y:e,color:o,canvas:r.currentCanvasId}))}})),(0,u.Z)(this,"restorePixel",(function(t,e){var n=r.waitingPixels["".concat(t,";").concat(e)];delete r.waitingPixels["".concat(t,";").concat(e)],r.placePixel(t,e,n),r.soundController.playSound(O.w.BAD),r.interactionController.shiftPressed=!1,r.interactionController.isAutoBrushing=!1,r.interactionController.isMouseDown=!1})),(0,u.Z)(this,"confirmPixel",(function(t,e){delete r.waitingPixels["".concat(t,";").concat(e)],r.soundController.playSound(O.w.NEUTRAL)})),(0,u.Z)(this,"changeZoom",(function(t,e,n){var o=r.canvasToCoordinates(e,n),a=o.coordX,i=o.coordY,s=r.coordinatesOnCanvas(a,i),c=s.posX,u=s.posY,l=r.position.zoom*t;if(l>=1&&l<_){var d=r.coordinatesOnCanvas(a,i,l),v=c-d.posX,f=u-d.posY,y=h.Z/l,g=v/y,m=f/y;p.h.getState().position.zoom=l,p.h.getState().position.x=r.position.x-g,p.h.getState().position.y=r.position.y-m,r.loadNeighboringChunks(),r.render()}})),(0,u.Z)(this,"setZoom",(function(t){null===p.h||void 0===p.h||p.h.dispatch({type:g.V1,payload:M(M({},r.position),{},{zoom:t})})})),(0,u.Z)(this,"setPosition",(function(t,e){null===p.h||void 0===p.h||p.h.dispatch({type:g.V1,payload:M(M({},r.position),{},{x:t,y:e})})})),(0,u.Z)(this,"changePosition",(function(t,e){var n=r.position.x+t,o=r.position.y+e;null===p.h||void 0===p.h||p.h.dispatch({type:g.V1,payload:M(M({},r.position),{},{x:n,y:o})})})),(0,u.Z)(this,"render",(function(){var t=r.canvas.getContext("2d");t&&(null===p.h||void 0===p.h||p.h.dispatch({type:g.r2,payload:!1}),t.clearRect(0,0,r.size.width,r.size.height),null!==p.h&&void 0!==p.h&&p.h.getState().eraserMode||null!==p.h&&void 0!==p.h&&p.h.getState().history.activate?(t.fillStyle="lightblue",t.fillRect(0,0,r.size.width,r.size.height)):r.drawSuperChunks(t),h.Z/r.position.zoom>.5&&r.drawChunks(t),null!==p.h&&void 0!==p.h&&p.h.getState().npzMode&&r.drawNpz(t),r.drawGrid(t),r.drawSquare(t),r.drawActivity(t),r.overlayController.render(t))})),(0,u.Z)(this,"drawGrid",(function(t){if(!(r.position.zoom>L||null===p.h||void 0===p.h)&&p.h.getState().gridActive){var e=(null===p.h||void 0===p.h?void 0:p.h.getState().gridSize)||10,n=document.documentElement.clientWidth,o=document.documentElement.clientHeight,a=h.Z/r.position.zoom,i={x:Math.round(r.position.x),y:Math.round(r.position.y)},s=r.coordinatesOnCanvas(i.x,i.y),c=Math.ceil(o/a)+2,u=Math.ceil(n/a)+2;t.strokeStyle="#2222227E";for(var l=i.y-c;l<i.y+c;l++){t.lineWidth=l%e===0?2:1,t.beginPath();var d=s.posY+(l-i.y)*a;t.moveTo(0,d),t.lineTo(n,d),t.stroke()}for(var v=i.x-u;v<i.x+u;v++){t.lineWidth=v%e===0?2:1,t.beginPath();var f=s.posX+(v-i.x)*a;t.moveTo(f,0),t.lineTo(f,o),t.stroke()}}})),(0,u.Z)(this,"drawSquare",(function(t){if(!(r.position.zoom>L)){var e=null===p.h||void 0===p.h?void 0:p.h.getState().cursorPos;if(e){var n=h.Z/r.position.zoom,o=r.coordinatesOnCanvas(e.x,e.y),a=o.posX,i=o.posY,s=r.getColorOnCoordinates(e.x,e.y);t.fillStyle=(null===p.h||void 0===p.h?void 0:p.h.getState().selectedColor)||"#FFFFFF",t.strokeStyle="#000000",t.fillRect(a,i,n,n),t.strokeRect(a,i,n,n),t.fillStyle=s||"lightblue",t.fillRect(a+3,i+3,n-6,n-6),t.strokeRect(a+3,i+3,n-6,n-6)}}})),(0,u.Z)(this,"drawSuperChunks",(function(t){t.imageSmoothingEnabled=!1;var e=h.Z/r.position.zoom,n=r.currentCanvas;r.superChunks.slice().filter((function(t,e){return r.canSuperchunkLoadOrDisplay(e,n)})).reverse().forEach((function(n){Object.keys(n).map((function(o){var a=n[o],i=r.coordinatesOnCanvas(a.position.x*a.chunkSize,a.position.y*a.chunkSize),s=i.posX,c=i.posY;t.drawImage(a.canvas,s,c,a.chunkSize*e,a.chunkSize*e)}))}))})),(0,u.Z)(this,"drawChunks",(function(t){t.imageSmoothingEnabled=!1;for(var e=h.Z/r.position.zoom,n=r.size.width,o=r.size.height,a=r.canvasToCoordinates(0,0),i=r.canvasToCoordinates(n,o),s=a.coordX-h.k;s<i.coordX+h.k;s+=h.k)for(var c=a.coordY-h.k;c<i.coordY+h.k;c+=h.k){var u=Math.floor(s/h.k),l=Math.floor(c/h.k),d=r.currentChunks["".concat(u,";").concat(l)];if(d){var v=r.coordinatesOnCanvas(d.position.x*h.k,d.position.y*h.k),p=v.posX,f=v.posY;t.drawImage(d.canvas,p,f,d.chunkSize*e,d.chunkSize*e)}}})),(0,u.Z)(this,"drawNpz",(function(t){var e,n=h.Z/r.position.zoom,o=r.size.width,a=r.size.height,i=r.canvasToCoordinates(0,0),s=r.canvasToCoordinates(o,a),c=(null!==(e=null===p.h||void 0===p.h?void 0:p.h.getState().npzList)&&void 0!==e?e:[]).filter((function(t){return t.startX<=s.coordX&&t.startY<=s.coordY&&t.endX>=i.coordX&&t.endY>=i.coordY}));t.beginPath(),c.forEach((function(e){var o=r.coordinatesOnCanvas(e.startX,e.startY),a=o.posX,i=o.posY;t.moveTo(a,i),t.lineTo(a+(e.endX-e.startX)*n,i),t.lineTo(a+(e.endX-e.startX)*n,i+(e.endY-e.startY)*n),t.lineTo(a,i+(e.endY-e.startY)*n)})),t.fillStyle="#FF000066",t.closePath(),t.fill()})),(0,u.Z)(this,"drawActivity",(function(t){t.fillStyle="#FF000066";var e=h.Z/r.position.zoom;r.pixelActivity=r.pixelActivity.map((function(n){var o=n.x,a=n.y,i=n.frame;if(i<=40){var s=r.coordinatesOnCanvas(o,a),c=s.posX,u=s.posY;t.beginPath(),t.arc(c+e/2,u+e/2,e*i/4,0,2*Math.PI),t.fill()}return{x:o,y:a,frame:i+1}})),r.pixelActivity=r.pixelActivity.filter((function(t){return t.frame<=41})),r.pixelActivity.length&&null!==p.h&&void 0!==p.h&&p.h.getState().activity&&!p.h.getState().history.activate?(r.activityTimeout&&clearTimeout(r.activityTimeout),r.activityTimeout=setTimeout((function(){null===p.h||void 0===p.h||p.h.dispatch({type:g.r2,payload:!0}),r.activityTimeout=null}),N)):r.pixelActivity.length&&(r.pixelActivity=[],r.activityTimeout&&clearTimeout(r.activityTimeout),r.activityTimeout=setTimeout((function(){null===p.h||void 0===p.h||p.h.dispatch({type:g.r2,payload:!0}),r.activityTimeout=null}),N))})),this.size={width:window.innerWidth,height:window.innerHeight};var c=document.getElementById("canvas");c.width=this.size.width,c.height=this.size.height,this.canvas=c,this.canvas.focus(),this.interactionController=new x(this),this.connectionController=new Z(this,e),this.overlayController=new D(this),this.soundController=new O.Z(this),this.loadFromLocalStorage(n)}return(0,c.Z)(t,[{key:"destructor",value:function(){this.interactionController.destructor(),this.connectionController.destructor(),this.overlayController.destructor()}},{key:"clearHistoryChunks",value:function(){this.historyChunks={}}},{key:"clearChunks",value:function(t){var e,n=this;t.length?(0,o.Z)(t).forEach((function(t){t.canvas===n.currentCanvasId&&delete n.chunks["".concat(t.x,";").concat(t.y)]})):(this.chunks={},this.waitingPixels={},this.historyChunks={},this.superChunks=(null===(e=this.currentCanvas)||void 0===e?void 0:e.superchunkLevels.map((function(){return{}})))||[]);null===p.h||void 0===p.h||p.h.dispatch({type:g.wv,payload:!1})}},{key:"loadFromLocalStorage",value:function(t){var e=localStorage.getItem("gridActive");e&&(null===p.h||void 0===p.h||p.h.dispatch({type:m.EA,payload:"true"===e}));var n=localStorage.getItem("zoomTowardCursor");n&&(null===p.h||void 0===p.h||p.h.dispatch({type:m.vw,payload:"true"===n}));var o=localStorage.getItem("activity");o&&(null===p.h||void 0===p.h||p.h.dispatch({type:m.jt,payload:"true"===o}));var r=localStorage.getItem("showChat");r&&(null===p.h||void 0===p.h||p.h.dispatch({type:P._7,payload:"true"===r}));var s=localStorage.getItem("overlayActive");s&&(null===p.h||void 0===p.h||p.h.dispatch({type:y.QF,payload:"true"===s}));var c=localStorage.getItem("overlayOpen");c&&(null===p.h||void 0===p.h||p.h.dispatch({type:y.ao,payload:"true"===c}));var u=localStorage.getItem("canvas");t?null===p.h||void 0===p.h||p.h.dispatch({type:m.bz,payload:t.canvas}):u?null===p.h||void 0===p.h||p.h.dispatch({type:m.bz,payload:u}):null===p.h||void 0===p.h||p.h.dispatch({type:m.bz,payload:p.h.getState().canvases[0].id});var l=localStorage.getItem("position");t?null===p.h||void 0===p.h||p.h.dispatch({type:g.V1,payload:{x:t.x,y:t.y,zoom:t.zoom}}):l&&(null===p.h||void 0===p.h||p.h.dispatch({type:g.V1,payload:JSON.parse(l)}));var h=localStorage.getItem("darkMode");h&&(null===p.h||void 0===p.h||p.h.dispatch({type:m.AC,payload:"true"===h}));var d=localStorage.getItem("gridSize");d&&(null===p.h||void 0===p.h||p.h.dispatch({type:m.d8,payload:Number(d)}));var v=localStorage.getItem("showButtons");v&&(null===p.h||void 0===p.h||p.h.dispatch({type:m.DV,payload:"true"===v}));var C=localStorage.getItem("showPalette");C&&(null===p.h||void 0===p.h||p.h.dispatch({type:m.Y1,payload:"true"===C}));var O=localStorage.getItem("lastReadNotificationDate");O&&(null===p.h||void 0===p.h||p.h.dispatch({type:f.Ik,payload:O}));var S=localStorage.getItem("notifications");S?null===p.h||void 0===p.h||p.h.dispatch({type:m.So,payload:"true"===S}):(0,i.Z)(a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Notification.requestPermission();case 2:"granted"===t.sent?null===p.h||void 0===p.h||p.h.dispatch({type:m.So,payload:!0}):null===p.h||void 0===p.h||p.h.dispatch({type:m.So,payload:!1});case 4:case"end":return t.stop()}}),t)})))();var w=localStorage.getItem("sounds");w&&(null===p.h||void 0===p.h||p.h.dispatch({type:m.iz,payload:"true"===w}))}},{key:"getColorOnCoordinates",value:function(t,e){var n,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=Math.floor(t/h.k),a=Math.floor(e/h.k);if((n=o?this.historyChunks:this.currentChunks)["".concat(r,";").concat(a)]){var i=t%h.k,s=e%h.k;i=i>=0?i:h.k+i,s=s>=0?s:h.k+s;var c=n["".concat(r,";").concat(a)];return c.getColorAt(i,s)}return""}},{key:"position",get:function(){return null===p.h||void 0===p.h?void 0:p.h.getState().position}},{key:"currentChunks",get:function(){return null!==p.h&&void 0!==p.h&&p.h.getState().history.activate?this.historyChunks:this.chunks}},{key:"currentCanvasId",get:function(){return p.h.getState().currentCanvas}},{key:"currentCanvasIndex",get:function(){return this.canvases.findIndex((function(t){return t.id===p.h.getState().currentCanvas}))}},{key:"canvases",get:function(){return p.h.getState().canvases}},{key:"currentCanvas",get:function(){return this.canvases.find((function(t){return t.id===p.h.getState().currentCanvas}))}}]),t}(),z=null;function U(){return z}function X(t,e){z=new j(t,e)}function B(){var t;null===(t=z)||void 0===t||t.destructor(),z=null}},1551:function(t,e,n){"use strict";n.d(e,{w:function(){return o},Z:function(){return u}});var o,r=n(6610),a=n(5991),i=n(6156),s=n(3596);!function(t){t.NEUTRAL="NEUTRAL",t.GOOD="GOOD",t.BAD="BAD",t.OPTIONS="OPTIONS"}(o||(o={}));var c=[{type:o.NEUTRAL,source:"/sounds/neutral.wav"},{type:o.GOOD,source:"/sounds/good.wav"},{type:o.BAD,source:"/sounds/bad.wav"},{type:o.OPTIONS,source:"/sounds/options.wav"}],u=function(){function t(e){(0,r.Z)(this,t),(0,i.Z)(this,"canvasController",void 0),(0,i.Z)(this,"sounds",[]),this.canvasController=e,this.sounds=c.map((function(t){var e=new Audio(t.source);return e.volume=.2,{type:t.type,audio:e}}))}return(0,a.Z)(t,[{key:"destructor",value:function(){this.sounds.map((function(t){t.audio.remove()}))}},{key:"playSound",value:function(t){if(null!==s.h&&void 0!==s.h&&s.h.getState().sounds){var e=this.sounds.find((function(e){return e.type===t}));e&&(e.audio.currentTime=0,e.audio.play())}}}]),t}()},1053:function(t,e,n){"use strict";n.d(e,{_7:function(){return c},P9:function(){return u},Qn:function(){return l},BZ:function(){return h},D:function(){return d},WV:function(){return s},hp:function(){return v}});var o=n(7329),r=n(6156);function a(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function i(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?a(Object(n),!0).forEach((function(e){(0,r.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var s,c="SET_SHOW_CHAT",u="SET_CHAT_MESSAGE",l="ADD_CHAT_MESSAGE",h="CLEAR_CHAT_MESSAGES",d="SET_CHANNEL";!function(t){t.INT="int",t.EN="en",t.FR="fr",t.RU="ru",t.ES="es",t.PT="pt",t.TR="tr",t.RO="ro"}(s||(s={}));var v=[{action:c,function:function(t,e){return localStorage.setItem("showChat",String(e.payload)),i(i({},t),{},{showChat:e.payload,unreadMessage:!e.payload&&t.unreadMessage})}},{action:u,function:function(t,e){var n=e.payload.map((function(t){return i(i({},t),{},{createdAt:new Date(t.createdAt)})}));return i(i({},t),{},{chatMessages:n,channelMessages:n.filter((function(e){return e.channel===t.channel||!e.channel}))})}},{action:l,function:function(t,e){var n=[].concat((0,o.Z)(t.chatMessages),[i(i({},e.payload),{},{createdAt:new Date(e.payload.createdAt)})]);return i(i({},t),{},{chatMessages:n,channelMessages:n.filter((function(e){return e.channel===t.channel||!e.channel})),unreadMessage:!t.showChat&&e.payload.channel===t.channel})}},{action:h,function:function(t,e){var n=t.chatMessages.map((function(t){return e.payload.includes(t.id)?i(i({},t),{},{msg:"<message deleted>"}):t}));return i(i({},t),{},{chatMessages:n,channelMessages:n.filter((function(e){return e.channel===t.channel||!e.channel})),unreadMessage:!t.showChat&&t.chatMessages.some((function(e){return e.channel===t.channel}))})}},{action:"SET_UNREAD_MESSAGE",function:function(t,e){return i(i({},t),{},{unreadMessage:e.payload})}},{action:d,function:function(t,e){var n=t.chatMessages.filter((function(t){return t.channel}));return i(i({},t),{},{chatMessages:n,channelMessages:t.chatMessages.filter((function(t){return t.channel===e.payload})),channel:e.payload})}}]},2929:function(t,e,n){"use strict";n.d(e,{US:function(){return i},qb:function(){return s},Qb:function(){return c},hp:function(){return u}});var o=n(6156);function r(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function a(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?r(Object(n),!0).forEach((function(e){(0,o.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var i="SET_HISTORY_MODE_ACTIVE",s="SET_HISTORY_DATE",c="SET_HISTORY_HOUR";var u=[{action:i,function:function(t,e){return a(a({},t),{},{history:a(a({},t.history),{},{activate:e.payload})})}},{action:s,function:function(t,e){return a(a({},t),{},{history:a(a({},t.history),{},{date:e.payload})})}},{action:c,function:function(t,e){return a(a({},t),{},{history:a(a({},t.history),{},{hour:e.payload})})}}]},7438:function(t,e,n){"use strict";n.d(e,{jz:function(){return c},G8:function(){return u},i0:function(){return l},lk:function(){return h},kA:function(){return d},ZS:function(){return v},dd:function(){return p},Kv:function(){return f},Ik:function(){return y},hp:function(){return g}});var o=n(6156),r=n(3848),a=n(4152);function i(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function s(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?i(Object(n),!0).forEach((function(e){(0,o.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var c="SET_NB_PLAYERS",u="SET_CURSOR_POS",l="SET_MODAL",h="SET_COOLDOWN",d="SET_ALERT",v="SET_SEARCH",p="SET_DISCONNECT",f="SET_LAST_NOTIFICATION_DATE",y="SET_LAST_READ_NOTIFICATION_DATE";var g=[{action:c,function:function(t,e){return s(s({},t),{},{playersNb:e.payload})}},{action:u,function:function(t,e){return s(s({},t),{},{shouldRender:t.position.zoom<a.rX||t.shouldRender,cursorPos:e.payload})}},{action:l,function:function(t,e){var n;return e.payload===r.Z.NONE&&(null===(n=(0,a.mh)())||void 0===n||n.canvas.focus()),s(s({},t),{},{currentModal:e.payload})}},{action:h,function:function(t,e){return s(s({},t),{},{cooldown:e.payload})}},{action:d,function:function(t,e){return s(s({},t),{},{alert:e.payload})}},{action:v,function:function(t,e){return s(s({},t),{},{searchActive:e.payload})}},{action:p,function:function(t,e){return s(s({},t),{},{disconnectReason:e.payload})}},{action:f,function:function(t,e){return s(s({},t),{},{lastNotificationDate:new Date(e.payload)})}},{action:y,function:function(t,e){return localStorage.setItem("lastReadNotificatonDate",e.payload),s(s({},t),{},{lastReadNotificationDate:new Date(e.payload)})}}]},9968:function(t,e,n){"use strict";n.d(e,{QF:function(){return i},ao:function(){return s},Hz:function(){return c},U4:function(){return u},fA:function(){return l},tt:function(){return h},El:function(){return d},UU:function(){return v},hp:function(){return p}});var o=n(6156);function r(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function a(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?r(Object(n),!0).forEach((function(e){(0,o.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var i="SET_ACTIVATE_OVERLAY",s="SET_OVERLAY_OPEN",c="SET_OVERLAY_IMAGE",u="SET_OVERLAY_TRANSPARENCY",l="SET_OVERLAY_POSITION",h="SET_OVERLAY_POSITION_MOUSE",d="SET_OVERLAY_AUTOCOLOR",v="SET_OVERLAY_TAINTED";var p=[{action:c,function:function(t,e){return a(a({},t),{},{shouldRender:!0,overlay:a(a({},t.overlay),{},{image:e.payload})})}},{action:s,function:function(t,e){return localStorage.setItem("overlayOpen",String(e.payload)),a(a({},t),{},{overlay:a(a({},t.overlay),{},{open:e.payload})})}},{action:i,function:function(t,e){return localStorage.setItem("overlayActive",String(e.payload)),a(a({},t),{},{shouldRender:!0,overlay:a(a({},t.overlay),{},{activate:e.payload})})}},{action:u,function:function(t,e){return a(a({},t),{},{shouldRender:!0,overlay:a(a({},t.overlay),{},{transparency:e.payload})})}},{action:l,function:function(t,e){return a(a({},t),{},{shouldRender:!0,overlay:a(a({},t.overlay),{},{position:e.payload})})}},{action:h,function:function(t,e){return a(a({},t),{},{overlay:a(a({},t.overlay),{},{positionMouse:e.payload})})}},{action:d,function:function(t,e){return a(a({},t),{},{overlay:a(a({},t.overlay),{},{autoColor:e.payload})})}},{action:v,function:function(t,e){return a(a({},t),{},{overlay:a(a({},t.overlay),{},{tainted:e.payload})})}}]},8296:function(t,e,n){"use strict";n.d(e,{Du:function(){return c},V1:function(){return u},r2:function(){return l},sW:function(){return h},wv:function(){return d},c5:function(){return v},Y5:function(){return p},JX:function(){return f},hp:function(){return y}});var o=n(6156),r=n(8200),a=n(4152);function i(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function s(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?i(Object(n),!0).forEach((function(e){(0,o.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var c="SET_SELECTED_COLOR",u="SET_POSITION",l="SET_SHOULD_RENDER",h="SET_SHOULD_LOAD_CHUNKS",d="SET_SHOULD_CLEAR_CHUNKS",v="SET_SHOULD_REFRESH_CHUNKS",p="SET_ERASER_MODE",f="SET_NPZ_MODE";var y=[{action:c,function:function(t,e){return s(s({},t),{},{shouldRender:!0,selectedColor:e.payload})}},{action:u,function:function(t,e){var n=t.canvases.find((function(e){return e.id===t.currentCanvas})),o=((null===n||void 0===n?void 0:n.size)||1)*r.k/2,i=e.payload.x<-o?-o:e.payload.x>o?o:e.payload.x,c=e.payload.y<-o?-o:e.payload.y>o?o:e.payload.y,u=e.payload.zoom<1?1:e.payload.zoom>=a.sZ?a.sZ-1:e.payload.zoom;return localStorage.setItem("position",JSON.stringify(e.payload)),s(s({},t),{},{position:{x:i,y:c,zoom:u},shouldRender:!0,shouldLoadChunks:!0})}},{action:l,function:function(t,e){return s(s({},t),{},{shouldRender:e.payload})}},{action:h,function:function(t,e){return s(s({},t),{},{shouldLoadChunks:e.payload})}},{action:v,function:function(t,e){return s(s({},t),{},{shouldRefreshChunks:e.payload.refresh,chunksToRefresh:e.payload.chunks})}},{action:d,function:function(t,e){return s(s({},t),{},{shouldClearChunks:e.payload})}},{action:p,function:function(t,e){return s(s({},t),{},{eraserMode:e.payload})}},{action:f,function:function(t,e){return s(s({},t),{},{npzMode:e.payload.activated,npzList:e.payload.npzs})}}]},3555:function(t,e,n){"use strict";n.d(e,{EA:function(){return i},vw:function(){return s},jt:function(){return c},So:function(){return u},iz:function(){return l},bz:function(){return h},AC:function(){return d},d8:function(){return v},DV:function(){return p},Y1:function(){return f},pq:function(){return y},hp:function(){return g}});var o=n(6156);function r(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function a(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?r(Object(n),!0).forEach((function(e){(0,o.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var i="SET_GRID_ACTIVE",s="SET_ZOOM_TOWARD_CURSOR",c="SET_ACTIVITY",u="SET_NOTIFICATIONS",l="SET_SOUNDS",h="SET_CANVAS",d="SET_DARK_MODE",v="SET_GRID_SIZE",p="SET_SHOW_BUTTONS",f="SET_SHOW_PALETTE",y="SET_AUTO_BRUSH";var g=[{action:i,function:function(t,e){return localStorage.setItem("gridActive",String(e.payload)),a(a({},t),{},{shouldRender:!0,gridActive:e.payload})}},{action:s,function:function(t,e){return localStorage.setItem("zoomTowardCursor",String(e.payload)),a(a({},t),{},{zoomTowardCursor:e.payload})}},{action:c,function:function(t,e){return localStorage.setItem("activity",String(e.payload)),a(a({},t),{},{shouldRender:!0,activity:e.payload})}},{action:u,function:function(t,e){var n=e.payload;return!0===e.payload?"denied"===Notification.permission?(alert("Notifications for this website are blocked, please enable them in your browser."),n=!1):"default"===Notification.permission&&(n=!1):n=!1,localStorage.setItem("notifications",String(n)),a(a({},t),{},{notifications:n})}},{action:l,function:function(t,e){return localStorage.setItem("sounds",String(e.payload)),a(a({},t),{},{sounds:e.payload})}},{action:h,function:function(t,e){var n,o;return localStorage.setItem("canvas",String(e.payload)),a(a({},t),{},{shouldLoadChunks:e.payload!==t.currentCanvas,currentCanvas:e.payload,shouldClearChunks:!0,selectedColor:null!==(n=null===(o=t.canvases.find((function(t){return t.id===e.payload})))||void 0===o?void 0:o.palette[0])&&void 0!==n?n:"#FFFFFF"})}},{action:d,function:function(t,e){return localStorage.setItem("darkMode",String(e.payload)),a(a({},t),{},{darkMode:e.payload})}},{action:v,function:function(t,e){return localStorage.setItem("gridSize",String(e.payload)),a(a({},t),{},{gridSize:e.payload})}},{action:p,function:function(t,e){return localStorage.setItem("showButtons",String(e.payload)),a(a({},t),{},{showButtons:e.payload})}},{action:f,function:function(t,e){return localStorage.setItem("showPalette",String(e.payload)),a(a({},t),{},{showPalette:e.payload})}},{action:y,function:function(t,e){return a(a({},t),{},{autoBrush:e.payload})}}]},3791:function(t,e,n){"use strict";n.d(e,{FW:function(){return o},QE:function(){return c},Cc:function(){return u},hp:function(){return l}});var o,r=n(6156),a=n(4152);function i(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function s(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?i(Object(n),!0).forEach((function(e){(0,r.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}!function(t){t.CLIENT="client",t.MOD="mod",t.ADMIN="admin"}(o||(o={}));var c="SET_USER",u="SET_NB_PIXELS";var l=[{action:c,function:function(t,e){var n,o;return e.payload?null===(n=(0,a.mh)())||void 0===n||n.connectionController.sendToWs("loginUser",localStorage.getItem("token")):null===(o=(0,a.mh)())||void 0===o||o.connectionController.sendToWs("logoutUser",{}),s(s({},t),{},{user:e.payload})}},{action:u,function:function(t,e){return t.user?s(s({},t),{},{user:s(s({},t.user),{},{totalPixels:e.payload.totalPixels,dailyPixels:e.payload.dailyPixels})}):t}}]},3596:function(t,e,n){"use strict";n.d(e,{E3:function(){return S},h:function(){return y},oR:function(){return E}});var o=n(6156),r=n(7294),a=n(879),i=n(6486),s=n(7438),c=n(8296),u=n(9968),l=n(1053),h=n(3555),d=n(3791),v=n(2929),p=[s.hp,c.hp,u.hp,l.hp,h.hp,d.hp,v.hp].flat();function f(t,e){var n=p.find((function(t){return(null===t||void 0===t?void 0:t.action)===e.type}));return n?n.function(t,e):t}var y,g=n(3848),m=n(4152);function C(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function O(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?C(Object(n),!0).forEach((function(e){(0,o.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var S={playersNb:0,cursorPos:{x:0,y:0},selectedColor:"#FFFFFF",currentModal:g.Z.NONE,cooldown:{},chatMessages:[],channelMessages:[],unreadMessage:!1,gridActive:!0,zoomTowardCursor:!0,activity:!0,showChat:!0,channel:l.WV.INT,shouldRender:!0,shouldLoadChunks:!0,shouldClearChunks:!1,shouldRefreshChunks:!1,chunksToRefresh:[],searchActive:!1,disconnectReason:"",notifications:!1,sounds:!0,darkMode:!1,gridSize:10,showButtons:!0,showPalette:!0,autoBrush:!1,eraserMode:!1,npzMode:!1,npzList:[],lastNotificationDate:new Date(0),lastReadNotificationDate:new Date(0),position:{x:0,y:0,zoom:1},history:{activate:!1,date:"",hour:""},overlay:{activate:!1,image:"",transparency:.5,position:{x:0,y:0},positionMouse:!1,autoColor:!1,tainted:!1,open:!1},alert:{show:!1,text:void 0,color:void 0},currentCanvas:"",canvases:[],user:void 0},w=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:S,e=arguments.length>1?arguments[1]:void 0;return f(t,e)},b=(0,i.throttle)((function(t){var e=(0,m.mh)();e&&(t.shouldClearChunks&&(null===e||void 0===e||e.clearChunks(t.chunksToRefresh)),t.shouldRender&&(null===e||void 0===e||e.render()),t.shouldLoadChunks&&(null===e||void 0===e||e.loadNeighboringChunks()),t.shouldRefreshChunks&&t.chunksToRefresh.length&&(null===e||void 0===e||e.refreshChunks(t.chunksToRefresh)))}),m.Hm),k=function(t){return function(e){return function(n){var o=e(n),r=t.getState();return r&&(r.shouldClearChunks||r.shouldRender||r.shouldLoadChunks||r.shouldRefreshChunks)&&b(r),o}}};function x(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:S;return(0,a.MT)(w,t,(0,a.md)(k))}function E(t){return(0,r.useMemo)((function(){return function(t){var e,n=null!==(e=y)&&void 0!==e?e:x(t);return t&&y&&(n=x(O(O({},y.getState()),t)),y=void 0),y||(y=n),n}(t)}),[t])}},5924:function(t,e,n){"use strict";n.d(e,{a:function(){return d},Z:function(){return C}});var o=n(5893),r=n(7329),a=n(7294),i=n(9163),s=n(2568),c=n.n(s),u=n(3596),l=n(5042);function h(t){return"#"+c()(t).substr(0,6)}var d,v=i.ZP.span.withConfig({displayName:"ChatFormatting__Position",componentId:"sc-13kz5a5-0"})(["color:",";padding:0 2px;cursor:pointer;&:hover{color:",";}"],(function(t){var e=t.darkMode;return(0,l.L)(l.w.LINK,e)}),(function(t){var e=t.darkMode;return(0,l.L)(l.w.HOVERED_LINK,e)})),p=i.ZP.span.withConfig({displayName:"ChatFormatting__Mention",componentId:"sc-13kz5a5-1"})(["",";",";padding:0 2px;"],(function(t){var e=t.isMe,n=t.color;return"".concat(e?"background-color":"color",": ").concat(n)}),(function(t){var e=t.isMe;return"".concat(e?"color":"background-color",": ").concat(e?(0,l.L)(l.w.TEXT,!0):"transparent")})),f=i.ZP.span.withConfig({displayName:"ChatFormatting__Greentext",componentId:"sc-13kz5a5-2"})(["color:green;"]),y=i.ZP.span.withConfig({displayName:"ChatFormatting__Redtext",componentId:"sc-13kz5a5-3"})(["color:red;"]),g=i.ZP.a.withConfig({displayName:"ChatFormatting__Link",componentId:"sc-13kz5a5-4"})(["color:blue;"]);!function(t){t.TEXT="TEXT",t.BREAK="BREAK",t.POSITION="POSITION",t.MENTION="MENTION",t.GREENTEXT="GREENTEXT",t.REDTEXT="REDTEXT",t.BOLD="BOLD",t.ITALICS="ITALICS",t.UNDERLINE="UNDERLINE",t.CROSSED="CROSSED",t.CODE="CODE",t.LINK="LINK"}(d||(d={}));var m=[{type:d.BREAK,regex:/\n/gm},{type:d.POSITION,regex:/#.\(-?\d*,\s*-?\d*,\s*-?\d*\)/gm},{type:d.MENTION,regex:/@[^\s]*/gm},{type:d.GREENTEXT,regex:/^>.*$/gm},{type:d.REDTEXT,regex:/^<.*$/gm},{type:d.BOLD,regex:/\*{2}(.*?(?:(?=\*{2}[^*])|(?=\*{2}$)))\*{2}/gm},{type:d.ITALICS,regex:/(?:[^\*]|^)\*([^*]+)\*(?:[^\*]|$)/gm},{type:d.UNDERLINE,regex:/_{2}([^_]+)_{2}/gm},{type:d.CROSSED,regex:/~{2}([^~]+)~{2}/gm},{type:d.CODE,regex:/`.*`/gm},{type:d.LINK,regex:/((([A-Za-z]{3,9}:(?:\/\/)?)(?:[\-;:&=\+\$,\w]+@)?[A-Za-z0-9\.\-]+|(?:www\.|[\-;:&=\+\$,\w]+@)[A-Za-z0-9\.\-]+)((?:\/[\+~%\/\.\w\-_]*)?\??(?:[\-\+=&;%@\.\w_]*)#?(?:[\.\!\/\\\w]*))?)/gm}];function C(t,e,n,i){var s;if(i>100)return(0,o.jsx)(a.Fragment,{children:t});var c=[];m.forEach((function(e){var n,o=e.type,a=e.regex,i=(0,r.Z)(t.matchAll(a)).map((function(t){return{type:o,text:t[0],index:t.index}}));(n=c).push.apply(n,(0,r.Z)(i.filter((function(t){return-1===c.findIndex((function(e){return t.index>=e.index&&t.index<e.index+e.text.length}))}))))})),c=(c=c.sort((function(t,e){return t.index-e.index}))).filter((function(t,e){return-1===c.findIndex((function(n,o){return e>o&&t.index>=n.index&&t.index<n.index+n.text.length}))}));var l=0;return(s=c).push.apply(s,(0,r.Z)(c.map((function(e){var n=e.index,o=e.text.length,r={type:d.TEXT,text:t.substr(l,n-l),index:l};return l=n+o,r})).concat([{type:d.TEXT,text:t.substr(l),index:l}]))),c=c.sort((function(t,e){return t.index-e.index})),(0,o.jsx)(o.Fragment,{children:c.map((function(t,r){var s,c=t.type,l=t.text;switch(c){case d.TEXT:return(0,o.jsx)(a.Fragment,{children:l},r);case d.BREAK:return(0,o.jsx)("br",{},r);case d.POSITION:return(0,o.jsx)(v,{onClick:function(){return e(d.POSITION,l)},darkMode:n,children:l},r);case d.MENTION:var m=l.replace("@","");return(0,o.jsx)(p,{isMe:m===(null===u.h||void 0===u.h||null===(s=u.h.getState().user)||void 0===s?void 0:s.username),color:h(m),darkMode:n,children:l},r);case d.BOLD:return(0,o.jsx)("b",{children:C(l.replace(/\*{2}/gm,""),e,n,i+1)},r);case d.ITALICS:return(0,o.jsx)("i",{children:C(l.replace(/\*/gm,""),e,n,i+1)},r);case d.UNDERLINE:return(0,o.jsx)("u",{children:C(l.replace(/_{2}/gm,""),e,n,i+1)},r);case d.CROSSED:return(0,o.jsx)("del",{children:C(l.replace(/~{2}/gm,""),e,n,i+1)},r);case d.CODE:return(0,o.jsx)("code",{children:l.replace(/`/gm,"")},r);case d.GREENTEXT:return(0,o.jsxs)(f,{children:[">",C(l.replace(">",""),e,n,i+1)]},r);case d.REDTEXT:return(0,o.jsxs)(y,{children:["<",C(l.replace("<",""),e,n,i+1)]},r);case d.LINK:return(0,o.jsx)(g,{href:(l.startsWith("http")?"":"//")+l,rel:"noreferrer noopener",target:"_blank",children:l},r)}}))})}},4684:function(t,e,n){"use strict";n.d(e,{dd:function(){return p},h5:function(){return f},ZP:function(){return g}});var o=n(5893),r=n(6610),a=n(5991),i=n(6156),s=n(7294),c=n(7296),u=n(9163),l=n(7714),h=n(5042),d=u.ZP.div.withConfig({displayName:"Converter__Container",componentId:"sc-1gsyz10-0"})(["display:flex;flex-direction:column;align-items:center;gap:0.5rem;button{color:",";}"],(function(t){var e=t.darkMode;return(0,h.L)(h.w.TEXT,e)})),v=u.ZP.div.withConfig({displayName:"Converter__ImagePreviewCanvas",componentId:"sc-1gsyz10-1"})([""]);function p(t){return t.map((function(t){return function(t){var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16),255]}(t)}))}function f(t,e){var n=t[0],o=t[1],r=t[2],a=t[3],i=e.map((function(t){var e=t[0],i=t[1],s=t[2],c=t[3];return[Math.hypot(Math.abs(n-e),Math.abs(o-i),Math.abs(r-s),Math.abs(a-c)),e,i,s,c]})).sort((function(t,e){return t[0]-e[0]}))[0];return[i[1],i[2],i[3],i[4]]}var y=new(function(){function t(){(0,r.Z)(this,t),(0,i.Z)(this,"canvas",null),(0,i.Z)(this,"palette",[])}return(0,a.Z)(t,[{key:"initCanvas",value:function(t){this.canvas||(this.canvas=document.createElement("canvas"),this.canvas.width=100,this.canvas.height=100),this.palette=t}},{key:"drawImage",value:function(t,e){this.canvas||this.initCanvas(this.palette);var n=this.canvas.getContext("2d");if(n){var o=e/t.width,r=t.width*o,a=t.height*o;if(n.clearRect(0,0,r,a),n.imageSmoothingEnabled=!1,a>=1){n.canvas.width=r,n.canvas.height=a,n.drawImage(t,0,0,r,a);for(var i=n.getImageData(0,0,r,a),s=i.data,c=function(t,e,n,o){for(var r=new Uint8ClampedArray(o),a=0;a<n;a++)for(var i=0;i<e;i++){var s=a*e*4+4*i;r[s]=t[a][i][0],r[s+1]=t[a][i][1],r[s+2]=t[a][i][2],r[s+3]=t[a][i][3]}return r}(function(t,e,n,o){var r=t,a=p(o);a.push([0,0,0,0]);for(var i=0;i<n;i++)for(var s=0;s<e;s++)r[i][s]=f(r[i][s],a);return r}(function(t,e,n){for(var o=new Array(n),r=0;r<n;r++){o[r]=new Array(e);for(var a=0;a<e;a++){var i=r*e*4+4*a;o[r][a]=[t[i],t[i+1],t[i+2],t[i+3]]}}return o}(s,i.width,i.height),i.width,i.height,this.palette),i.width,i.height,s.length),u=0;u<s.length;u++)s[u]=c[u];n.clearRect(0,0,i.width,i.height),n.putImageData(i,0,0)}}return this.canvas}}]),t}());function g(){var t=(0,c.$G)("converter").t,e=(0,s.useRef)(null),n=(0,s.useRef)(null),r=(0,l.v9)((function(t){return t.darkMode})),a=(0,l.v9)((function(t){return t.canvases.find((function(e){return e.id===t.currentCanvas}))})),i=(0,s.useState)(50),u=i[0],h=i[1],p=(0,s.useState)(null),f=p[0],g=p[1],m=(0,s.useState)(!1),C=m[0],O=m[1];(0,s.useEffect)((function(){f&&S(f)}),[u,C]);function S(t){var n,o=null===(n=e.current)||void 0===n?void 0:n.getContext("2d");if(o){var r=u/t.width,i=t.width*r*(C?5:1),s=t.height*r*(C?5:1);if(s>=1){var c;o.canvas.width=i,o.canvas.height=s,o.imageSmoothingEnabled=!1,y.initCanvas(null!==(c=null===a||void 0===a?void 0:a.palette)&&void 0!==c?c:[]);var l=y.drawImage(t,u);if(o.drawImage(l,0,0,i,s),C){o.strokeStyle="#222222",o.lineWidth=1;for(var h=0;h<i-i%5+5;h+=5)o.beginPath(),o.moveTo(h+.5,0),o.lineTo(h+.5,s),o.stroke(),h%50===0&&0!==h&&(o.beginPath(),o.moveTo(h-1+.5,0),o.lineTo(h-1+.5,s),o.stroke());for(var d=0;d<s-s%5+5;d+=5)o.beginPath(),o.moveTo(0,d+.5),o.lineTo(i,d+.5),o.stroke(),d%50===0&&0!==d&&(o.beginPath(),o.moveTo(0,d-1+.5),o.lineTo(i,d-1+.5),o.stroke())}}}}return(0,o.jsxs)(d,{darkMode:r,children:[t("widthText"),(0,o.jsx)("input",{type:"number",id:"wantedWidth",defaultValue:"50",min:"1",onChange:function(t){t.stopPropagation(),t.preventDefault(),h(Number(t.target.value))}}),(0,o.jsx)("br",{}),t("uploadText"),(0,o.jsx)("input",{type:"file",id:"file",ref:n,style:{display:"none"},onChange:function(t){if(t.stopPropagation(),t.preventDefault(),t.target.files){var e=URL.createObjectURL(t.target.files[0]),n=new Image;n.src=e,g(n),n.onload=function(){S(n)}}}}),(0,o.jsx)("button",{onClick:function(){n.current&&n.current.click()},type:"button",children:t("uploadBtn")}),(0,o.jsxs)("div",{onClick:function(t){O(!C),t.stopPropagation()},children:[(0,o.jsx)("span",{children:t("addGrid")}),(0,o.jsx)("input",{type:"checkbox",checked:C,readOnly:!0})]}),(0,o.jsx)("hr",{}),(0,o.jsx)(v,{darkMode:r,children:(0,o.jsx)("canvas",{ref:e,id:"preview"})}),(0,o.jsx)("hr",{}),(0,o.jsx)("button",{onClick:function(){var t,n=null===(t=e.current)||void 0===t?void 0:t.getContext("2d");if(n){var o=n.canvas.toDataURL("image/png"),r=document.createElement("a");r.download="converter.png",r.href=o,r.click()}},type:"button",children:t("downloadBtn")})]})}},6915:function(t,e,n){"use strict";n.d(e,{K3:function(){return r},Tv:function(){return a},$K:function(){return i},yz:function(){return s},zx:function(){return c},VK:function(){return u},gx:function(){return l},jP:function(){return h},bx:function(){return d},$d:function(){return p}});var o=n(9163),r=o.ZP.div.withConfig({displayName:"pagesComponents__BoxContainer",componentId:"sc-sxgowe-0"})(["border-radius:.5rem;margin:1rem auto;background-color:rgba(0,0,0,0.2);max-width:1500px;width:100%;box-sizing:border-box;"," "," @media(max-width:500px){margin:0.5rem auto;}"],(function(t){return"success"===t.status&&(0,o.iv)(["border:2px solid #3aa1a1;"])}),(function(t){return"error"===t.status&&(0,o.iv)(["border:2px solid #a53030;"])})),a=o.ZP.div.withConfig({displayName:"pagesComponents__ErrorBox",componentId:"sc-sxgowe-1"})(["padding:1rem;color:#a53030;@media(max-width:500px){padding:0.5rem;}"]),i=o.ZP.h1.withConfig({displayName:"pagesComponents__BoxTitle",componentId:"sc-sxgowe-2"})(["font-size:1.5rem;padding:1rem;margin:0;@media(max-width:500px){font-size:0.7rem;padding:0.5rem 1rem;}"]),s=o.ZP.form.withConfig({displayName:"pagesComponents__QueryForm",componentId:"sc-sxgowe-3"})(["display:flex;flex-direction:column;align-self:stretch;gap:0.5rem;label{padding:1rem;}button{display:flex;align-items:center;padding:1rem;color:#ffffffa0;background-color:rgba(0,0,0,0.2);border:none;border-radius:0;font-size:1rem;cursor:pointer;transition:.1s;svg{transition:.2s;}&:hover{background-color:rgba(0,0,0,0.3);svg{color:#4bc0c0;}}}@media(max-width:500px){label{padding:0.5rem;}button{padding:0.5rem;font-size:0.7rem;svg{width:16px;height:16px;}}}"]),c=o.ZP.button.withConfig({displayName:"pagesComponents__Button",componentId:"sc-sxgowe-4"})(["display:flex;align-items:center;padding:1rem;color:#ffffffa0;background-color:rgba(0,0,0,0.2);border:none;border-radius:0;font-size:1rem;cursor:pointer;transition:.1s;svg{transition:.2s;}&:hover{background-color:rgba(0,0,0,0.3);svg{color:#4bc0c0;}}@media(max-width:500px){button{padding:0.5rem;font-size:0.7rem;svg{width:16px;height:16px;}}}"]),u=o.ZP.input.withConfig({displayName:"pagesComponents__Textfield",componentId:"sc-sxgowe-5"})(["flex:1;padding:1rem;color:#ffffffa0;background-color:rgba(0,0,0,0.2);border:none;border-radius:0;min-width:5rem;&:hover{outline-offset:0px;outline:-webkit-focus-ring-color auto 1px;}color-scheme:dark;@media(max-width:500px){font-size:0.7rem;padding:0.5rem;}"]),l=o.ZP.textarea.withConfig({displayName:"pagesComponents__Textarea",componentId:"sc-sxgowe-6"})(["font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;flex:1;padding:1rem;color:#ffffffa0;background-color:rgba(0,0,0,0.2);border:none;border-radius:0;min-width:5rem;&:hover{outline-offset:0px;outline:-webkit-focus-ring-color auto 1px;}@media(max-width:500px){font-size:0.7rem;padding:0.5rem;}"]),h=(o.ZP.div.withConfig({displayName:"pagesComponents__Checkbox",componentId:"sc-sxgowe-7"})(["display:flex;align-items:center;justify-content:center;cursor:pointer;padding:1rem;background-color:rgba(0,0,0,0.2);svg{transition:.2s;}&:hover{svg{color:#4bc0c0;}}@media(max-width:500px){padding:0.5rem;svg{width:16px;height:16px;}}"]),o.ZP.div.withConfig({displayName:"pagesComponents__CoordRow",componentId:"sc-sxgowe-8"})(["display:flex;flex-direction:row;align-items:stretch;gap:0.5rem;"])),d=o.ZP.div.withConfig({displayName:"pagesComponents__BoxRow",componentId:"sc-sxgowe-9"})(["padding:1rem;display:flex;flex-direction:row;align-items:center;gap:0.5rem;"]),v={w:"world",a:"art"};function p(t,e,n,o){var r=t.clipboardData.getData("Text").match(/#(.)\((-?\d*),\s*(-?\d*),\s*(-?\d*)\)/);if(r&&5===r.length){var a=r[1],i=Number(r[2]),s=Number(r[3]);if(!Object.keys(v).includes(a))return!1;var c=v[a];return t.preventDefault(),e(i),n(s),o(c),!0}return!1}}}]);